# babel-plugin-react-move-anonymous-inline-style-objects

Lift inline anonymous objects on `style` and `css` props in JSX outside of the render's scope. This will benefit a component that will be rendered multiple times as it prevents a new anonymous object being created on every render. In reality, the performance gain is ever so slight although [it seems to scale roughly linearly with the size of the object](https://perf.link/#eyJpZCI6InR3OHpvOWt2ZjRnIiwidGl0bGUiOiJGaW5kaW5nIG51bWJlcnMgaW4gYW4gYXJyYXkgb2YgMTAwMCIsImJlZm9yZSI6ImNvbnN0IGNyZWF0ZVRoZU9iamVjdCA9IChjb2xvcikgPT4gKHsgY29sb3IsIGJhY2tncm91bmRDb2xvcjogYGJsdWVgLCBmb250U2l6ZTogMTYsIG1hcmdpbjogOCwgcGFkZGluZ0hvcml6b250YWw6IDggfSlcbmNvbnN0IGIgPSB7IGNvbG9yOiBgcmVkYCwgYmFja2dyb3VuZENvbG9yOiBgYmx1ZWAsIGZvbnRTaXplOiAxNiwgbWFyZ2luOiA4LCBwYWRkaW5nSG9yaXpvbnRhbDogOCB9IiwidGVzdHMiOlt7Im5hbWUiOiJMYXJnZSBvYmplY3QiLCJjb2RlIjoiY29uc3Qgc3R5bGUgPSB7IFxuICBmbGV4OiAxLFxuICBqdXN0aWZ5Q29udGVudDogYGNlbnRlcmAsXG4gIGFsaWduSXRlbXM6IGBjZW50ZXJgLFxuICBoZWlnaHQ6IGAxMDAlYCxcbiAgbWluSGVpZ2h0OiAyMDAsXG4gIGJvcmRlclJhZGl1czogMjQsXG4gIHdpZHRoOiA0MDAsXG4gIG1hcmdpblZlcnRpY2FsOiA3LFxuICBwb3NpdGlvbjogYHJlbGF0aXZlYCxcbiAgekluZGV4OiAyLFxuICBib3JkZXJUb3BXaWR0aDogMSxcbiAgYm9yZGVyVG9wQ29sb3I6IGB5ZWxsb3dgLFxuICBib3JkZXJCb3R0b21XaWR0aDogMSxcbiAgYm9yZGVyQm90dG9tQ29sb3I6IGBibHVlYCxcbiAgc3ZnOiB7XG4gICAgIGRpc3BsYXk6ICdub25lJyxcbiAgfSxcbiAgcDoge1xuICAgICBjb2xvcjogJ2JsdWUnLFxuICB9LFxuICAnQG1lZGlhIChtaW4td2lkdGg6NzY4cHgpJzoge1xuICAgICBtaW5IZWlnaHQ6IGBhdXRvYCxcbiAgICAgd2lkdGg6IGAxMDAlYCxcbiAgIH0sXG59IiwicnVucyI6WzEwODAwMDAsMjQ5MDAwLDE0MTQwMDAsNzczMDAwLDEyNzEwMDAsMTQzMzAwMCwxMjQ5MDAwLDExMTAwMDAsMTI1MTAwMCw4MDkwMDAsNzAzMDAwLDE5MjMwMDAsNjc4MDAwLDEwNTAwMCw5MTcwMDAsNzUwMDAsMzE5MDAwLDMwMDAwMCwxNDQwMDAwLDEyNDEwMDAsNTg5MDAwLDE5ODAwMCwxMjc5MDAwLDc0MDAwLDEwMDgwMDAsMTIwMDAsNzI1MDAwLDEyNDAwMCwxMzY0MDAwLDExODEwMDAsMTMwMDAsMTk3MjAwMCw5OTMwMDAsMjAyMDAwLDM4ODAwMCwxMDQwMDAwLDM4MjAwMCwyNDQwMDAsMTI3OTAwMCw2NjgwMDAsMTQxNzAwMCwxMDIyMDAwLDEwMDAsMTIyMDAwLDEwOTMwMDAsOTIwMDAsMTYyMjAwMCwxNDA4MDAwLDM4OTAwMCwxMjcxMDAwLDEwODAwMDAsMjkwMDAsMTcwMDAwLDEzNzAwMDAsMjAxMDAwLDkzOTAwMCwxNTQ1MDAwLDMxODAwMCwyMzAwMCwxMDkwMDAsMTQzMjAwMCwxMzQxMDAwLDI4MDAwMCwxNTA1MDAwLDEzMDQwMDAsMTU2NzAwMCwxMjAxMDAwLDYxNjAwMCwxNDE1MDAwLDE2ODEwMDAsMjQ5MDAwLDEzMDAwLDAsMTMyNTAwMCwxNTc0MDAwLDM2NTAwMCwxNjg4MDAwLDc2MDAwMCw1MjAwMCwxNTc0MDAwLDEzMDAwLDE1ODYwMDAsNjkyMDAwLDUwMDAsMjk5MDAwLDY0NDAwMCwxMjQwMDAwLDEyMDAwMDAsNzQ4MDAwLDUyMzAwMCwzMDQwMDAsMTAwMCwyMjgwMDAsMzQ0MDAwLDE3NTMwMDAsMTc2MDAwLDU3MDAwMCwyODAwMCwyNjIwMDAsMTg5OTAwMF0sIm9wcyI6Nzg3NTMwfSx7Im5hbWUiOiJUZXN0IENhc2UiLCJjb2RlIjoiY29uc3Qgc3R5bGUgPSB7IGNvbG9yOiBgcmVkYCB9IiwicnVucyI6WzIxMDYwMDAsNDI2MDAwMCw1NDA1MDAwLDE4MjcwMDAsMjQwNTAwMCw2MzYwMDAsNjMyMDAwLDEyNDcwMDAsMTM3MjAwMCwzMjMxMDAwLDUwMjkwMDAsNDc5ODAwMCwxODczMDAwLDE1OTkwMDAsNjU4MDAwMCwxMjQwMDAsMjQ5MzAwMCwxNjA5MDAwLDEyNTgwMDAsNDMzMDAwMCw1ODAxMDAwLDI0MTAwMCw0MzY1MDAwLDI4NTEwMDAsNDk1OTAwMCw0NDQ0MDAwLDkxNjAwMCwxOTQwMDAwLDc1NjAwMCwyODcxMDAwLDU5MjcwMDAsMTEzODAwMCw2MzExMDAwLDIxOTUwMDAsNTk0MTAwMCwzMDk0MDAwLDI0NzQwMDAsMzA5MzAwMCw2NjAwMCwzODkxMDAwLDExMjUwMDAsNTI3NTAwMCwyMzAwMDAsMTMyNDAwMCw0NzQ5MDAwLDI3MzcwMDAsNDI2NjAwMCwyMzk2MDAwLDM1MzYwMDAsMTg2NzAwMCwyMTY4MDAwLDUxMjYwMDAsMjM5MDAwMCwxMzQ2MDAwLDEwMDAsMTU1NzAwMCwzMjIxMDAwLDM5MzYwMDAsMTY4MTAwMCw1ODIzMDAwLDU4NzcwMDAsMjc3MjAwMCwzMjU2MDAwLDEwMDAsMjczNzAwMCw0ODk5MDAwLDQ4NDcwMDAsMjgwMDAsMjU2NTAwMCwxNzU1MDAwLDY4NDAwMCwxMzk2MDAwLDMxNDEwMDAsMTQ2MjAwMCw2MDc3MDAwLDM3NjEwMDAsMzk4MTAwMCwxMjUxMDAwLDYyNzYwMDAsNDAxMjAwMCwzNzgwMDAsMTAwMCwyNzk1MDAwLDU0MTEwMDAsNTc2ODAwMCwyOTA2MDAwLDQ2OTgwMDAsNDIxNjAwMCw0MDY2MDAwLDQzMzAwMDAsNjI4MDAwLDQ2MTAwMCwxMTU3MDAwLDQ2ODAwMCw2MTM5MDAwLDQ1NTcwMDAsMjQxNzAwMCwzMDAwLDQ2NzEwMDAsNjg5NDAwMF0sIm9wcyI6MjkzNTg0MH0seyJuYW1lIjoiVGVzdCBDYXNlIiwiY29kZSI6ImNvbnN0IHN0eWxlID0geyBjb2xvcjogYHJlZGAsIGJhY2tncm91bmRDb2xvcjogYGJsdWVgLCBmb250U2l6ZTogMTYsIG1hcmdpbjogOCwgcGFkZGluZ0hvcml6b250YWw6IDggfSIsInJ1bnMiOlszNTQ3MDAwLDY4MjAwMCwxMjAwMCwzNjE1MDAwLDUyNTIwMDAsNjcwMDAwLDIzNjUwMDAsNjc3MDAwLDMwMDAsNDA5NTAwMCwyOTYyMDAwLDc4MjAwMCw1MzAxMDAwLDE1NzgwMDAsMjk4NzAwMCwzNjU4MDAwLDI1MDAwLDMwNzQwMDAsMTg0NzAwMCwyNjgwMDAwLDM4MDAwMCw1OTA0MDAwLDUwMzIwMDAsMjgzNzAwMCwyNzcwMDAwLDI5MTcwMDAsODUwMDAwLDcxMTAwMCw0OTAwMDAwLDQ0ODQwMDAsMzYyNzAwMCwxODE0MDAwLDE0MjAwMDAsNDA0ODAwMCw1MzUzMDAwLDE5NzEwMDAsMjMwMDAsNDMyODAwMCwxNjAwMDAsMTU3ODAwMCw5MDgwMDAsNTY1MDAwLDExMTAwMCwyMzY1MDAwLDI5OTUwMDAsNDI4MTAwMCwxNzY0MDAwLDI3NTkwMDAsMjY4MDAwMCwyNTg4MDAwLDE2NTYwMDAsNDAxNDAwMCw2MzAwMDAsMjQwMDAwLDUyNTUwMDAsMTQyMDAwMCw4MTAwMCw0MzAxMDAwLDQxNTQwMDAsNDQ5NDAwMCwxODUyMDAwLDM1MDcwMDAsMjg5NDAwMCw1MDAwLDI3MDAwLDIwNjQwMDAsMjcxMzAwMCwyOTk1MDAwLDE2MDAwMCwyNDEzMDAwLDk0MDAwMCwxNDI5MDAwLDEwNTkwMDAsMjEyOTAwMCwxMzAwMCwyODM4MDAwLDMxMzkwMDAsNDY0NDAwMCwyMzAwMCwyMzkwMDAsNDAxNDAwMCwzMjE2MDAwLDE3MzUwMDAsNTA2NTAwMCw0MjMzMDAwLDgxMDAwLDUzOTIwMDAsMjM4NzAwMCw1NzQ3MDAwLDM2NjkwMDAsNTMxMTAwMCwxNTgwMDAsMjk1MDAwLDIwMzUwMDAsMTI2MzAwMCw0ODE1MDAwLDQwMTQwMDAsODEwMDAsNDAxNDAwMCw3MTAwMF0sIm9wcyI6MjQwODU5MH0seyJuYW1lIjoiV3JhcCBpbiBhIGZ1bmN0aW9uIGNhbGwiLCJjb2RlIjoiY29uc3Qgc3R5bGUgPSBjcmVhdGVUaGVPYmplY3QoJ3JlZCcpIiwicnVucyI6WzAsMTg2MDAwLDQzODMwMDAsOTAwMDAsMzEwNzAwMCwxMDExMDAwLDE5ODAwMDAsNjMwMDAsMCw3MjAwMDAsNjE4MDAwLDEwMDAsMTcyNzAwMCwxMDU2MDAwLDI3NjgwMDAsMTkzNTAwMCwxOTQ5MDAwLDIyMjIwMDAsMzE2MjAwMCwyODI1MDAwLDE5NzAwMDAsMTU3OTAwMCwyNjAzMDAwLDIwNjEwMDAsMzExODAwMCwyMTM4MDAwLDM1NTIwMDAsMjQyODAwMCwzMDUzMDAwLDEzMzgwMDAsMTI3MTAwMCwxNjgyMDAwLDAsMzA4MzAwMCwxMTczMDAwLDI3NTEwMDAsMjQ3MDAwLDMyNjAwMCwxNDI5MDAwLDI2MTAwMDAsNTU4MDAwLDI1NzIwMDAsMjQwMDAsMjQ5NDAwMCwwLDMwNTcwMDAsMTAwMCw0MTk3MDAwLDgwNjAwMCw0MDQyMDAwLDU2MjAwMCwyNTMyMDAwLDQ2MDYwMDAsNDE2MDAwMCwyNjA0MDAwLDk1NjAwMCw1OTgwMDAsMjUxMTAwMCwxODMxMDAwLDExMTAwMDAsMTU1MDAwMCwzMjg4MDAwLDIxNjAwMDAsMzAyNzAwMCwwLDMwMDQwMDAsMzI0MTAwMCw1NjIwMDAsMTc3ODAwMCw2MzAwMCwxNDk3MDAwLDg4NTAwMCw1NjUwMDAsMjc3NDAwMCwyNDcwMDAsMjM3NDAwMCwxODYwMDAwLDQwNzkwMDAsMTAwMCwxMjIwMDAwLDE2OTAwMCwxMDAyMDAwLDE3MzYwMDAsODY2MDAwLDM4NzYwMDAsNDAyOTAwMCwxMzAwMCwyNTMyMDAwLDQ0MTkwMDAsMjc4ODAwMCw2NDUwMDAsMjA1OTAwMCwxNDAwMDAsMzUwMDAwMCwxMDAwMCwzMDA0MDAwLDE5MDEwMDAsNDQ5MTAwMCw5MDIwMDAsMjQ3MDAwXSwib3BzIjoxNzk5NDAwfSx7Im5hbWUiOiJDcmVhdGUgYW4gb2JqZWN0IiwiY29kZSI6ImNvbnN0IHN0eWxlID0gYiIsInJ1bnMiOlsxMzY5MDAwLDE2NDYwMDAsNjE0NzAwMCw3NDgwMDAsMTUzNTAwMCw2NTY1MDAwLDIzNTYwMDAsMTA4MDAwLDY0MzMwMDAsMzYyMjAwMCwxMDgyMDAwLDIzNzcwMDAsNjE0NzAwMCwxNzMzMDAwLDU5MTcwMDAsMTc5ODAwMCwxMDI3MDAwLDM3NTgwMDAsNjYxMDAwLDQ2MzkwMDAsMzU2OTAwMCw3MTcwMDAwLDMwNzUwMDAsMjg3NzAwMCwzNDUwMDAsODkzMDAwLDUxMjMwMDAsNDYwMTAwMCw1MTIxMDAwLDg5MDAwMCwyMTU0MDAwLDU3OTQwMDAsMjYxODAwMCw1MTYxMDAwLDMwNzUwMDAsNDc5OTAwMCwxMDI3MDAwLDE3MTcwMDAsNjQ2MzAwMCw0MTcyMDAwLDE0MzQwMDAsMjE1NzAwMCw2MTQ3MDAwLDM5OTQwMDAsNjM5MDAwLDUwNzEwMDAsMzQ1MDAwLDcwMzEwMDAsNDg0OTAwMCw2Mzg2MDAwLDE0NzYwMDAsMjA2NzAwMCwyMjQ3MDAwLDc2NTMwMDAsNDg1MzAwMCwxMjUzMDAwLDY4NjAwMCwzMDAwLDMwMjQwMDAsMzI1MDAwMCw0MTIwMDAwLDMwNzUwMDAsMjI3MDAwMCwzNTQzMDAwLDE3MTgwMDAsMTM2MTAwMCwyNjE0MDAwLDUwNzIwMDAsMzAwMCwzNDAwMCwxNzEwMDAwLDI2NzIwMDAsNTEyMzAwMCwxMzY5MDAwLDEwMjUwMDAsODcxMDAwLDQzMjYwMDAsNTE5NTAwMCw3MDU0MDAwLDM5NDEwMDAsNzY0MDAwLDIyMTIwMDAsNjIxNTAwMCw1MzQwMDAsNTk3NzAwMCw2ODQyMDAwLDIxNjAwMCwzNDUwMDAsNTA1MjAwMCwxNjc3MDAwLDEzMzkwMDAsODA5MDAwLDY5NjgwMDAsNjM2ODAwMCw0MDIwMDAsMjU1NzAwMCw2ODMwMDAwLDQwMjUwMDAsNzAyMDAwLDcyNDAwMF0sIm9wcyI6MzEyNTMxMH1dLCJ1cGRhdGVkIjoiMjAyMC0wOS0yNVQxNjowNToxOC4zOTdaIn0%3D), so it might be worth considering still!

Taking suggestions for a name too ðŸŒš

## Disclaimer

This was written just to learn how to create a babel plugin, I wouldn't recommend using it ðŸ‘»

## Example

**In**

```js
import React from "react"

const MyComponent = () => <div style={{ color: "red" }} />
```

**Out**

```js
import React from "react"

var bpmio__style__0 = {
  color: "red",
}

const MyComponent = () => <div style={bpmio__style__0} />
```

## Gotchas

This is only a proof of concept, and a big emphasis on it being a work in progress.

It currently does not support logical expressions or conditonal expressions inside the `style` or `css` props. This is because there is additional work to be done to detect if it's safe to move the object to the top of the module scope without breaking any references to scopes it does not have access to, like variables from state. This means this plugin only moves the anonymous object if *all* values are a string literal (not a template literal) or a numerical literal.

**Supported**

```js
import React from "react"

const SupportedStringLiteral = () => <div style={{ color: "red" }} />
const SupportedNumericLiteral = () => <div style={{ padding: 32 }} />
```

**Not supported**

```js
import React from "react"

const NotSupportedTemplateLiteral = () => <div style={{ color: `red` }} />
const NotSupportedTemplateLiteralWithConditional = () => <div style={{ padding: `${process.env.IS_TOUCH_DEVICE ? 32 : 0}` }} />
const NotSupportedConditional = () => <div style={{ color: process.env.IS_SOME_VALUE && `red` }} />
const NotSupportedTenary = () => <div style={{ color: process.env.IS_SOME_VALUE ? "yellow" : "blue" }} />
```
